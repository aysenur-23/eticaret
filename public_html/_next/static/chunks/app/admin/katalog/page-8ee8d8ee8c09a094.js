(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3393],{6125:function(e,a,t){Promise.resolve().then(t.bind(t,779))},779:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return k}});var s=t(7437),i=t(2265),l=t(9376),r=t(7648),n=t(6070),c=t(2869),d=t(5186),o=t(6815),m=t(5974),u=t(6110),x=t(3647),h=t(9397),p=t(3247),f=t(5863),g=t(5675),j=t(8930),v=t(9412),N=t(6039);let y=["Diğer",...v.ws.flatMap(e=>e.categoryValues)];function k(){var e;let a=(0,l.useRouter)(),[v,k]=(0,i.useState)([]),[b,w]=(0,i.useState)(!0),[D,C]=(0,i.useState)(""),[F,S]=(0,i.useState)(!1),[z,_]=(0,i.useState)(null),[Z,I]=(0,i.useState)(!1),[L,M]=(0,i.useState)(null),[R,P]=(0,i.useState)({name:"",price:"",category:"Diğer",description:"",fullDescription:"",image:"",stock:"",featured:!1,sku:"",brand:""}),Y=async()=>{if(w(!0),!localStorage.getItem("admin_uid")){a.push("/admin/auth"),w(!1);return}try{let{collection:e,getDocs:a}=await Promise.all([t.e(4358),t.e(9697),t.e(6370)]).then(t.bind(t,5978)),{getDb:s}=await Promise.all([t.e(4358),t.e(139),t.e(9697),t.e(6370),t.e(6565),t.e(4257)]).then(t.bind(t,4257)),i=s(),l=(await a(e(i,"catalog"))).docs.map(e=>{var a,t;let s=e.data();return{id:e.id,name:s.name||"",category:s.category||"Diğer",price:s.price||0,stock:null!==(a=s.stock)&&void 0!==a?a:0,featured:null!==(t=s.featured)&&void 0!==t&&t,description:s.description,fullDescription:s.fullDescription,image:s.image,sku:s.sku,brand:s.brand}});if(0===l.length){let{mockProducts:e}=await t.e(4712).then(t.bind(t,4712)),a=e.map(e=>{var a;return{id:e.id||e.slug,name:e.name,category:e.category||"Diğer",price:e.price||0,stock:null!==(a=e.stock)&&void 0!==a?a:0,featured:e.isFeatured||!1,description:e.description,image:e.image}});k(a)}else k(l)}catch(e){k([])}finally{w(!1)}};(0,i.useEffect)(()=>{Y()},[a]);let E=v.filter(e=>e.name.toLowerCase().includes(D.toLowerCase())||(e.id||"").toLowerCase().includes(D.toLowerCase())||(e.sku||"").toLowerCase().includes(D.toLowerCase())),K=e=>{var a,t,s,i,l,r,n;_(e.id),P({name:e.name,price:String(e.price),category:e.category||"Diğer",description:null!==(a=e.description)&&void 0!==a?a:"",fullDescription:null!==(t=e.fullDescription)&&void 0!==t?t:"",image:null!==(s=e.image)&&void 0!==s?s:"",stock:String(null!==(i=e.stock)&&void 0!==i?i:""),featured:null!==(l=e.featured)&&void 0!==l&&l,sku:null!==(r=e.sku)&&void 0!==r?r:"",brand:null!==(n=e.brand)&&void 0!==n?n:""}),S(!0)},T=async e=>{e.preventDefault(),I(!0);try{let{doc:e,setDoc:a,addDoc:s,collection:i,serverTimestamp:l}=await Promise.all([t.e(4358),t.e(9697),t.e(6370)]).then(t.bind(t,5978)),{getDb:r}=await Promise.all([t.e(4358),t.e(139),t.e(9697),t.e(6370),t.e(6565),t.e(4257)]).then(t.bind(t,4257)),n=r(),c={name:R.name.trim(),price:Number(R.price)||0,category:R.category.trim()||"Diğer",description:R.description.trim()||null,fullDescription:R.fullDescription.trim()||null,image:R.image.trim()||null,stock:""!==R.stock?Math.max(0,Math.floor(Number(R.stock))):null,featured:R.featured,sku:R.sku.trim()||null,brand:R.brand.trim()||null,updatedAt:l()};z?await a(e(n,"catalog",z),c,{merge:!0}):await s(i(n,"catalog"),{...c,createdAt:l()}),S(!1),Y()}finally{I(!1)}},U=async e=>{if(confirm("Bu \xfcr\xfcn d\xfczenlemesini kaldırmak istediğinize emin misiniz? (Mock \xfcr\xfcnse orijinal hali kalır.)")){M(e);try{let{doc:a,deleteDoc:s}=await Promise.all([t.e(4358),t.e(9697),t.e(6370)]).then(t.bind(t,5978)),{getDb:i}=await Promise.all([t.e(4358),t.e(139),t.e(9697),t.e(6370),t.e(6565),t.e(4257)]).then(t.bind(t,4257)),l=i();await s(a(l,"catalog",e)),Y()}finally{M(null)}}};return(0,s.jsxs)("div",{className:"space-y-8 pb-safe",id:"main-content",children:[(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-slate-900",children:"Katalog / \xdcr\xfcn D\xfczenleme"}),(0,s.jsx)("p",{className:"text-slate-600 mt-1",children:"Site kataloğundaki \xfcr\xfcnleri d\xfczenleyin veya yeni \xfcr\xfcn ekleyin"})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(r.default,{href:"/admin/urunler",children:(0,s.jsx)(c.z,{variant:"outline",size:"sm",children:"Stok Y\xf6netimi"})}),(0,s.jsxs)(c.z,{onClick:()=>{_(null),P({name:"",price:"",category:"Diğer",description:"",fullDescription:"",image:"",stock:"",featured:!1,sku:"",brand:""}),S(!0)},className:"shrink-0",children:[(0,s.jsx)(h.Z,{className:"w-4 h-4 mr-2"}),"Yeni \xfcr\xfcn"]})]})]}),(0,s.jsxs)(n.Zb,{className:"border-slate-200/80 bg-white shadow-sm",children:[(0,s.jsx)(n.Ol,{children:(0,s.jsx)("div",{className:"flex flex-col sm:flex-row gap-4",children:(0,s.jsxs)("div",{className:"flex-1 relative",children:[(0,s.jsx)(p.Z,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400 shrink-0"}),(0,s.jsx)(d.I,{placeholder:"\xdcr\xfcn ara (isim, ID veya SKU)...",value:D,onChange:e=>C(e.target.value),className:"pl-10 min-w-0 border-slate-200"})]})})}),(0,s.jsx)(n.aY,{children:b?(0,s.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,s.jsx)(f.Z,{className:"w-8 h-8 animate-spin text-slate-400"})}):0===E.length?(0,s.jsx)("p",{className:"text-slate-500 py-8 text-center",children:"\xdcr\xfcn bulunamadı."}):(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"w-full text-sm",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{className:"border-b border-slate-200",children:[(0,s.jsx)("th",{className:"text-left py-3 px-2 font-medium text-slate-700",children:"\xdcr\xfcn"}),(0,s.jsx)("th",{className:"text-left py-3 px-2 font-medium text-slate-700",children:"Kategori"}),(0,s.jsx)("th",{className:"text-left py-3 px-2 font-medium text-slate-700",children:"Fiyat"}),(0,s.jsx)("th",{className:"text-left py-3 px-2 font-medium text-slate-700",children:"Stok"}),(0,s.jsx)("th",{className:"text-left py-3 px-2 font-medium text-slate-700",children:"\xd6ne \xe7ıkan"}),(0,s.jsx)("th",{className:"text-right py-3 px-2 font-medium text-slate-700",children:"İşlem"})]})}),(0,s.jsx)("tbody",{children:E.map(e=>(0,s.jsxs)("tr",{className:"border-b border-slate-100 hover:bg-slate-50/50",children:[(0,s.jsxs)("td",{className:"py-3 px-2",children:[(0,s.jsx)("div",{className:"font-medium text-slate-900 max-w-[280px] truncate",title:e.name,children:e.name}),e.sku&&(0,s.jsx)("div",{className:"text-xs text-slate-500 font-mono",children:e.sku})]}),(0,s.jsx)("td",{className:"py-3 px-2 text-slate-600 max-w-[180px] truncate",title:e.category,children:e.category}),(0,s.jsx)("td",{className:"py-3 px-2 tabular-nums",children:(0,N.ZM)(e.price)}),(0,s.jsx)("td",{className:"py-3 px-2",children:e.stock}),(0,s.jsx)("td",{className:"py-3 px-2",children:e.featured?(0,s.jsx)(m.C,{className:"bg-green-100 text-green-800 border-0",children:"Evet"}):(0,s.jsx)("span",{className:"text-slate-400",children:"–"})}),(0,s.jsxs)("td",{className:"py-3 px-2 text-right",children:[(0,s.jsx)(c.z,{variant:"ghost",size:"icon",onClick:()=>K(e),className:"h-8 w-8",children:(0,s.jsx)(g.Z,{className:"w-4 h-4"})}),(0,s.jsx)(c.z,{variant:"ghost",size:"icon",onClick:()=>U(e.id),disabled:L===e.id,className:"h-8 w-8 text-red-600 hover:text-red-700 hover:bg-red-50",children:L===e.id?(0,s.jsx)(f.Z,{className:"w-4 h-4 animate-spin"}):(0,s.jsx)(j.Z,{className:"w-4 h-4"})})]})]},e.id))})]})})})]}),(0,s.jsx)(u.Vq,{open:F,onOpenChange:S,children:(0,s.jsxs)(u.cZ,{className:"max-w-lg max-h-[90vh] overflow-y-auto",children:[(0,s.jsxs)(u.fK,{children:[(0,s.jsx)(u.$N,{children:z?"\xdcr\xfcn\xfc d\xfczenle":"Yeni \xfcr\xfcn"}),(0,s.jsx)(u.Be,{children:z?"Değiştirmek istediğiniz alanları g\xfcncelleyin.":"Yeni \xfcr\xfcn i\xe7in zorunlu alanları doldurun."})]}),(0,s.jsxs)("form",{onSubmit:T,className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(o._,{htmlFor:"name",children:"\xdcr\xfcn adı *"}),(0,s.jsx)(d.I,{id:"name",value:R.name,onChange:e=>P(a=>({...a,name:e.target.value})),placeholder:"\xdcr\xfcn adı",required:!0,className:"mt-1"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(o._,{htmlFor:"price",children:"Fiyat (TL) *"}),(0,s.jsx)(d.I,{id:"price",type:"number",min:0,step:.01,value:R.price,onChange:e=>P(a=>({...a,price:e.target.value})),required:!0,className:"mt-1"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(o._,{htmlFor:"category",children:"Kategori *"}),(0,s.jsxs)(x.Ph,{value:null!==(e=R.category)&&void 0!==e?e:"",onValueChange:e=>P(a=>({...a,category:e})),children:[(0,s.jsx)(x.i4,{className:"mt-1",children:(0,s.jsx)(x.ki,{})}),(0,s.jsx)(x.Bw,{children:y.map(e=>(0,s.jsx)(x.Ql,{value:e,children:e},e))})]})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(o._,{htmlFor:"stock",children:"Stok"}),(0,s.jsx)(d.I,{id:"stock",type:"number",min:0,value:R.stock,onChange:e=>P(a=>({...a,stock:e.target.value})),placeholder:"0",className:"mt-1"})]}),(0,s.jsx)("div",{className:"flex items-end gap-2 pb-2",children:(0,s.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,s.jsx)("input",{type:"checkbox",checked:R.featured,onChange:e=>P(a=>({...a,featured:e.target.checked})),className:"rounded border-slate-300"}),(0,s.jsx)("span",{className:"text-sm",children:"\xd6ne \xe7ıkan"})]})})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(o._,{htmlFor:"sku",children:"SKU"}),(0,s.jsx)(d.I,{id:"sku",value:R.sku,onChange:e=>P(a=>({...a,sku:e.target.value})),placeholder:"\xd6rn. \xdcRUN-001",className:"mt-1"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(o._,{htmlFor:"brand",children:"Marka"}),(0,s.jsx)(d.I,{id:"brand",value:R.brand,onChange:e=>P(a=>({...a,brand:e.target.value})),placeholder:"Marka adı",className:"mt-1"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(o._,{htmlFor:"image",children:"G\xf6rsel URL"}),(0,s.jsx)(d.I,{id:"image",value:R.image,onChange:e=>P(a=>({...a,image:e.target.value})),placeholder:"/images/products/urun.jpg",className:"mt-1"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(o._,{htmlFor:"description",children:"Kısa a\xe7ıklama"}),(0,s.jsx)("textarea",{id:"description",value:R.description,onChange:e=>P(a=>({...a,description:e.target.value})),placeholder:"Liste ve kartlarda g\xf6r\xfcnen kısa metin",rows:2,className:"mt-1 w-full rounded-md border border-slate-200 px-3 py-2 text-sm"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(o._,{htmlFor:"fullDescription",children:"Uzun a\xe7ıklama"}),(0,s.jsx)("textarea",{id:"fullDescription",value:R.fullDescription,onChange:e=>P(a=>({...a,fullDescription:e.target.value})),placeholder:"\xdcr\xfcn detay sayfası a\xe7ıklama sekmesi",rows:4,className:"mt-1 w-full rounded-md border border-slate-200 px-3 py-2 text-sm"})]}),(0,s.jsxs)(u.cN,{children:[(0,s.jsx)(c.z,{type:"button",variant:"outline",onClick:()=>S(!1),children:"İptal"}),(0,s.jsxs)(c.z,{type:"submit",disabled:Z,children:[Z?(0,s.jsx)(f.Z,{className:"w-4 h-4 animate-spin"}):null,z?"G\xfcncelle":"Oluştur"]})]})]})]})})]})}},6039:function(e,a,t){"use strict";function s(e){if(null==e)return"-";let a=Number(e);return isNaN(a)||!isFinite(a)?"-":new Intl.NumberFormat("tr-TR",{style:"currency",currency:"TRY",minimumFractionDigits:2,maximumFractionDigits:2}).format(a)}function i(e,a,t){if(null==e)return"-";let s=Number(e);if(isNaN(s)||!isFinite(s))return"-";if("TRY"===a||!t)return new Intl.NumberFormat("tr-TR",{style:"currency",currency:"TRY",minimumFractionDigits:2,maximumFractionDigits:2}).format(s);let i=s*(t[a]||0);return new Intl.NumberFormat("EUR"===a?"de-DE":"en-US",{style:"currency",currency:a,minimumFractionDigits:2,maximumFractionDigits:2}).format(i)}t.d(a,{ZM:function(){return s},uM:function(){return i}})},3247:function(e,a,t){"use strict";t.d(a,{Z:function(){return s}});let s=(0,t(9763).Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},7648:function(e,a,t){"use strict";t.d(a,{default:function(){return i.a}});var s=t(2972),i=t.n(s)}},function(e){e.O(0,[2972,8743,2249,3347,4116,6324,9766,481,7466,2971,2117,1744],function(){return e(e.s=6125)}),_N_E=e.O()}]);