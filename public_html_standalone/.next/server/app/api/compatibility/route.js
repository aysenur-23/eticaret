"use strict";(()=>{var e={};e.id=5853,e.ids=[5853],e.modules={53524:e=>{e.exports=require("@prisma/client")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},23633:(e,t,r)=>{r.r(t),r.d(t,{headerHooks:()=>h,originalPathname:()=>A,patchFetch:()=>f,requestAsyncStorage:()=>p,routeModule:()=>c,serverHooks:()=>k,staticGenerationAsyncStorage:()=>m,staticGenerationBailout:()=>d});var a={};r.r(a),r.d(a,{POST:()=>l});var s=r(95419),i=r(69108),n=r(99678),u=r(78070),o=r(3214);async function l(e){try{let{cellId:t,bmsId:r,chargerId:a,connectorId:s,ns:i,np:n,iRequired:l}=await e.json();if(!t||!r||!a||!s||!i||!n)return u.Z.json({error:"Gerekli alanlar eksik"},{status:400});let[c,p,m,k]=await Promise.all([o._.cell.findUnique({where:{id:t}}),o._.bMS.findUnique({where:{id:r}}),o._.charger.findUnique({where:{id:a}}),o._.connector.findUnique({where:{id:s}})]);if(!c||!p||!m||!k)return u.Z.json({error:"Bileşen bulunamadı"},{status:404});let h=function(e,t,r,a,s,i){let n=function(e,t,r,a){let s=[],i=[];e.chemistry!==t.chemistry&&s.push(`Kimya uyumsuzluğu: ${e.chemistry} vs ${t.chemistry}`),(r<t.seriesMin||r>t.seriesMax)&&s.push(`Seri sayısı uyumsuzluğu: ${r} (BMS: ${t.seriesMin}-${t.seriesMax})`);let n=a*e.contDischargeA;n>t.contA?s.push(`Akım uyumsuzluğu: Gerekli ${n}A, BMS ${t.contA}A`):n>.8*t.contA&&i.push(`Akım sınırda: Gerekli ${n}A, BMS ${t.contA}A`);let u=a*e.peakDischargeA;u>t.peakA&&s.push(`Pik akım uyumsuzluğu: Gerekli ${u}A, BMS ${t.peakA}A`);let o=e.maxChargeV,l=e.cutOffV;t.ovpV<1.05*o&&i.push(`Aşırı voltaj koruması d\xfcş\xfck: ${t.ovpV}V vs ${o}V`),t.uvpV>.95*l&&i.push(`D\xfcş\xfck voltaj koruması y\xfcksek: ${t.uvpV}V vs ${l}V`);let c="compatible";return s.length>0?c="incompatible":i.length>0&&(c="borderline"),{status:c,issues:s,warnings:i,recommendations:[]}}(e,t,s,i),u=function(e,t,r,a){let s=[],i=[],n=[],u=r*e.nominalV,o=a*e.maxChargeA,l=Math.abs(t.outV-u),c=.05*u;l>c?s.push(`Voltaj uyumsuzluğu: Şarj ${t.outV}V vs Batarya ${u}V`):l>.5*c&&i.push(`Voltaj sınırda: Şarj ${t.outV}V vs Batarya ${u}V`),t.outA>o?(i.push(`Şarj akımı y\xfcksek: ${t.outA}A vs Gerekli ${o}A`),n.push("Şarj akımını d\xfcş\xfcr\xfcn veya daha g\xfc\xe7l\xfc h\xfccreler kullanın")):t.outA<.5*o&&(i.push(`Şarj akımı d\xfcş\xfck: ${t.outA}A vs Gerekli ${o}A`),n.push("Şarj s\xfcresi uzun olacak"));let p="compatible";return s.length>0?p="incompatible":i.length>0&&(p="borderline"),{status:p,issues:s,warnings:i,recommendations:n}}(e,r,s,i),o=function(e,t,r){let a=[],s=[],i=[];r>t.contA?a.push(`Konekt\xf6r akım uyumsuzluğu: Gerekli ${r}A, Konekt\xf6r ${t.contA}A`):r>.8*t.contA&&s.push(`Konekt\xf6r akım sınırda: Gerekli ${r}A, Konekt\xf6r ${t.contA}A`),e.peakA>(t.peakA||t.contA)&&s.push(`Pik akım uyumsuzluğu: BMS ${e.peakA}A vs Konekt\xf6r ${t.peakA||t.contA}A`),r>20&&!t.antiSpark&&i.push("Y\xfcksek akım i\xe7in anti-spark konekt\xf6r \xf6nerilir");let n="compatible";return a.length>0?n="incompatible":s.length>0&&(n="borderline"),{status:n,issues:a,warnings:s,recommendations:i}}(t,a,i*e.contDischargeA),l=[n.status,u.status,o.status],c=l.includes("incompatible"),p=l.includes("borderline"),m="compatible";c?m="incompatible":p&&(m="borderline");let k=[...n.issues,...u.issues,...o.issues],h=[...n.warnings,...u.warnings,...o.warnings],d={status:m,issues:k,warnings:h,recommendations:[...n.recommendations,...u.recommendations,...o.recommendations]};return{cellBms:n,cellCharger:u,bmsConnector:o,overall:d}}(c,p,m,k,i,n);return u.Z.json({success:!0,data:h})}catch(e){return console.error("Compatibility check error:",e),u.Z.json({error:"Sunucu hatası"},{status:500})}}let c=new s.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/compatibility/route",pathname:"/api/compatibility",filename:"route",bundlePath:"app/api/compatibility/route"},resolvedPagePath:"C:\\Users\\aslan\\Desktop\\masa\xfcst\xfc-10.25\\DIY_battery\\app\\api\\compatibility\\route.ts",nextConfigOutput:"standalone",userland:a}),{requestAsyncStorage:p,staticGenerationAsyncStorage:m,serverHooks:k,headerHooks:h,staticGenerationBailout:d}=c,A="/api/compatibility/route";function f(){return(0,n.patchFetch)({serverHooks:k,staticGenerationAsyncStorage:m})}},3214:(e,t,r)=>{r.d(t,{_:()=>s});var a=r(53524);let s=globalThis.prisma??new a.PrismaClient({log:["error"]})}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[1638,6206],()=>r(23633));module.exports=a})();