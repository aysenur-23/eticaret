"use strict";(()=>{var e={};e.id=9118,e.ids=[9118],e.modules={53524:e=>{e.exports=require("@prisma/client")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},17252:e=>{e.exports=require("prettier/plugins/html")},87413:e=>{e.exports=require("prettier/standalone")},50852:e=>{e.exports=require("async_hooks")},32081:e=>{e.exports=require("child_process")},6113:e=>{e.exports=require("crypto")},9523:e=>{e.exports=require("dns")},82361:e=>{e.exports=require("events")},57147:e=>{e.exports=require("fs")},13685:e=>{e.exports=require("http")},95687:e=>{e.exports=require("https")},41808:e=>{e.exports=require("net")},84492:e=>{e.exports=require("node:stream")},22037:e=>{e.exports=require("os")},71017:e=>{e.exports=require("path")},12781:e=>{e.exports=require("stream")},24404:e=>{e.exports=require("tls")},57310:e=>{e.exports=require("url")},73837:e=>{e.exports=require("util")},59796:e=>{e.exports=require("zlib")},36864:(e,r,t)=>{t.r(r),t.d(r,{headerHooks:()=>$,originalPathname:()=>L,patchFetch:()=>W,requestAsyncStorage:()=>F,routeModule:()=>A,serverHooks:()=>O,staticGenerationAsyncStorage:()=>I,staticGenerationBailout:()=>H});var s={};t.r(s),t.d(s,{POST:()=>C});var o=t(95419),a=t(69108),i=t(99678),n=t(78070),l=t(3214),c=t(39145),p=t(6113),u=t.n(p),d=t(40002),m=t.n(d),x=t(25036),f=t(87165),g=t(56434),h=t(66802),y=t(3948),S=t(71601),b=t(80029),P=t(86543),T=t(1568);function w({name:e,resetUrl:r}){return(0,x.jsxs)(f.V,{children:[x.jsx(g.F,{}),x.jsx(h.u,{style:v,children:(0,x.jsxs)(y.W,{style:M,children:[x.jsx(S.$,{style:j,children:x.jsx(b.x,{style:k,children:"\uD83D\uDD0B Batarya Kit"})}),(0,x.jsxs)(S.$,{style:q,children:[x.jsx(b.x,{style:E,children:"Şifre Sıfırlama"}),(0,x.jsxs)(b.x,{style:_,children:["Merhaba ",x.jsx("strong",{children:e}),","]}),x.jsx(b.x,{style:_,children:"Şifrenizi sıfırlamak i\xe7in aşağıdaki bağlantıya tıklayın. Bu bağlantı 1 saat s\xfcreyle ge\xe7erlidir."}),x.jsx(S.$,{style:z,children:x.jsx(P.z,{style:D,href:r,children:"Şifremi Sıfırla"})}),x.jsx(b.x,{style:_,children:"Eğer bu isteği siz yapmadıysanız, bu e-postayı g\xf6rmezden gelebilirsiniz. Şifreniz değişmeyecektir."}),x.jsx(T.Hr,{style:R}),x.jsx(b.x,{style:B,children:"Bu bağlantı 1 saat s\xfcreyle ge\xe7erlidir. Bağlantıyı kopyalayıp tarayıcınıza yapıştırabilirsiniz:"}),x.jsx(b.x,{style:U,children:r})]})]})})]})}let v={backgroundColor:"#f6f9fc",fontFamily:'-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Ubuntu,sans-serif'},M={backgroundColor:"#ffffff",margin:"0 auto",padding:"20px 0 48px",marginBottom:"64px"},j={padding:"32px 24px 0",textAlign:"center"},k={color:"#2563eb",fontSize:"24px",fontWeight:"bold",margin:"0 0 8px"},q={padding:"0 24px"},E={color:"#1f2937",fontSize:"24px",fontWeight:"bold",margin:"0 0 16px",textAlign:"center"},_={color:"#374151",fontSize:"16px",lineHeight:"24px",margin:"0 0 16px"},z={textAlign:"center",margin:"24px 0"},D={backgroundColor:"#2563eb",borderRadius:"6px",color:"#ffffff",fontSize:"16px",fontWeight:"bold",textDecoration:"none",textAlign:"center",display:"inline-block",padding:"12px 24px"},R={borderColor:"#e5e7eb",margin:"24px 0"},B={color:"#6b7280",fontSize:"14px",lineHeight:"20px",margin:"0 0 8px"},U={color:"#2563eb",fontSize:"12px",wordBreak:"break-all",margin:"0"};async function C(e){try{let{email:r}=await e.json();if(!r)return n.Z.json({success:!1,error:"E-posta adresi gerekli"},{status:400});let t=await l._.user.findUnique({where:{email:r.toLowerCase()}});if(!t)return n.Z.json({success:!0,message:"Eğer bu e-posta adresi kayıtlıysa, şifre sıfırlama bağlantısı g\xf6nderildi."});let s=u().randomBytes(32).toString("hex"),o=new Date(Date.now()+36e5);await l._.user.update({where:{id:t.id},data:{resetToken:s,resetTokenExpiry:o}});let a=`${process.env.NEXT_PUBLIC_SITE_URL||"http://localhost:3000"}/reset-password?token=${s}`,i=m().createElement(w,{name:t.name,resetUrl:a});try{let e=await (0,c.KX)(t.email,"Şifre Sıfırlama - Batarya Kit",i);e.success?console.log("Password reset email sent successfully to:",t.email):console.error("Failed to send password reset email:",e.error)}catch(e){console.error("Email sending error:",e)}return n.Z.json({success:!0,message:"Eğer bu e-posta adresi kayıtlıysa, şifre sıfırlama bağlantısı g\xf6nderildi."})}catch(e){return console.error("Forgot password error:",e),n.Z.json({success:!1,error:"Bir hata oluştu"},{status:500})}}let A=new o.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/auth/forgot-password/route",pathname:"/api/auth/forgot-password",filename:"route",bundlePath:"app/api/auth/forgot-password/route"},resolvedPagePath:"C:\\Users\\aslan\\Desktop\\masa\xfcst\xfc-10.25\\DIY_battery\\app\\api\\auth\\forgot-password\\route.ts",nextConfigOutput:"standalone",userland:s}),{requestAsyncStorage:F,staticGenerationAsyncStorage:I,serverHooks:O,headerHooks:$,staticGenerationBailout:H}=A,L="/api/auth/forgot-password/route";function W(){return(0,i.patchFetch)({serverHooks:O,staticGenerationAsyncStorage:I})}},39145:(e,r,t)=>{t.d(r,{ED:()=>l,KX:()=>n});var s=t(68140),o=t(2532);t(40002);let a=null,i=()=>{if(a)return a;let e={host:process.env.SMTP_HOST||"smtp.hostinger.com",port:parseInt(process.env.SMTP_PORT||"465"),secure:"false"!==process.env.SMTP_SECURE,auth:{user:process.env.SMTP_USER||process.env.SMTP_EMAIL,pass:process.env.SMTP_PASSWORD},tls:{rejectUnauthorized:"false"!==process.env.SMTP_TLS_REJECT_UNAUTHORIZED,ciphers:"SSLv3"},pool:!0,maxConnections:5,maxMessages:100,connectionTimeout:1e4,greetingTimeout:1e4,socketTimeout:1e4,retry:{attempts:3,delay:2e3}};return a=s.createTransport(e)};async function n(e,r,t){if(!process.env.SMTP_USER||!process.env.SMTP_PASSWORD)return console.warn("SMTP credentials not set, skipping email send"),{success:!1,error:"SMTP not configured"};let s=Date.now();try{let a;let n=i();a="string"==typeof t?t:await Promise.race([(0,o.sY)(t),new Promise((e,r)=>setTimeout(()=>r(Error("Email render timeout")),5e3))]);let l=n.sendMail({from:process.env.SMTP_FROM||`"Batarya Kit" <${process.env.SMTP_USER}>`,to:e,subject:r,html:a,text:a.replace(/<[^>]*>/g,"").substring(0,500)}),c=await Promise.race([l,new Promise((e,r)=>setTimeout(()=>r(Error("SMTP send timeout")),3e4))]),p=Date.now()-s;return console.log(`Email sent in ${p}ms:`,c.messageId),{success:!0,data:{id:c.messageId,response:c.response,duration:`${p}ms`}}}catch(t){let e=Date.now()-s;console.error(`SMTP email send error (${e}ms):`,t);let r="Failed to send email";return t instanceof Error&&(r=t.message.includes("timeout")?"Email send timeout - SMTP server may be slow or unreachable":t.message.includes("authentication")?"SMTP authentication failed - check username and password":t.message.includes("connection")?"SMTP connection failed - check host and port":t.message),{success:!1,error:r}}}async function l(){try{let e=i();return await e.verify(),console.log("SMTP connection verified"),!0}catch(e){return console.error("SMTP verification failed:",e),!1}}},3214:(e,r,t)=>{t.d(r,{_:()=>o});var s=t(53524);let o=globalThis.prisma??new s.PrismaClient({log:["error"]})}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[1638,6206,4730,6878],()=>t(36864));module.exports=s})();