"use strict";(()=>{var e={};e.id=2748,e.ids=[2748],e.modules={53524:e=>{e.exports=require("@prisma/client")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},81130:(e,r,i)=>{i.r(r),i.d(r,{headerHooks:()=>f,originalPathname:()=>k,patchFetch:()=>v,requestAsyncStorage:()=>d,routeModule:()=>c,serverHooks:()=>p,staticGenerationAsyncStorage:()=>m,staticGenerationBailout:()=>h});var a={};i.r(a),i.d(a,{GET:()=>l});var t=i(95419),s=i(69108),n=i(99678),o=i(78070),u=i(3214);async function l(e){try{let r=e.nextUrl.searchParams,i=r.get("token"),a=r.get("code"),t=r.get("email");if(!i&&!a)return o.Z.json({success:!1,error:"Doğrulama token'ı veya kodu gerekli"},{status:400});if(i){let r=await u._.user.findUnique({where:{emailVerificationToken:i}});if(!r)return o.Z.json({success:!1,error:"Ge\xe7ersiz veya s\xfcresi dolmuş doğrulama linki"},{status:400});if(r.emailVerificationExpires&&r.emailVerificationExpires<new Date)return o.Z.json({success:!1,error:"Doğrulama linkinin s\xfcresi dolmuş. L\xfctfen yeni bir doğrulama e-postası isteyin."},{status:400});return await u._.user.update({where:{id:r.id},data:{emailVerified:!0,emailVerificationToken:null,emailVerificationExpires:null}}),o.Z.redirect(new URL("/login?verified=true",e.url))}if(a&&t){let e=await u._.user.findUnique({where:{email:t.toLowerCase()}});if(!e)return o.Z.json({success:!1,error:"Kullanıcı bulunamadı"},{status:400});let r=e.emailVerificationToken?.slice(-6).toUpperCase();if(a.toUpperCase()!==r)return o.Z.json({success:!1,error:"Ge\xe7ersiz doğrulama kodu"},{status:400});if(e.emailVerificationExpires&&e.emailVerificationExpires<new Date)return o.Z.json({success:!1,error:"Doğrulama kodunun s\xfcresi dolmuş. L\xfctfen yeni bir doğrulama e-postası isteyin."},{status:400});return await u._.user.update({where:{id:e.id},data:{emailVerified:!0,emailVerificationToken:null,emailVerificationExpires:null}}),o.Z.json({success:!0,message:"E-posta adresiniz başarıyla doğrulandı"})}return o.Z.json({success:!1,error:"Ge\xe7ersiz istek"},{status:400})}catch(e){return console.error("Email verification error:",e),o.Z.json({success:!1,error:"Bir hata oluştu"},{status:500})}}let c=new t.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/auth/verify-email/route",pathname:"/api/auth/verify-email",filename:"route",bundlePath:"app/api/auth/verify-email/route"},resolvedPagePath:"C:\\Users\\aslan\\Desktop\\masa\xfcst\xfc-10.25\\DIY_battery\\app\\api\\auth\\verify-email\\route.ts",nextConfigOutput:"standalone",userland:a}),{requestAsyncStorage:d,staticGenerationAsyncStorage:m,serverHooks:p,headerHooks:f,staticGenerationBailout:h}=c,k="/api/auth/verify-email/route";function v(){return(0,n.patchFetch)({serverHooks:p,staticGenerationAsyncStorage:m})}},3214:(e,r,i)=>{i.d(r,{_:()=>t});var a=i(53524);let t=globalThis.prisma??new a.PrismaClient({log:["error"]})}};var r=require("../../../../webpack-runtime.js");r.C(e);var i=e=>r(r.s=e),a=r.X(0,[1638,6206],()=>i(81130));module.exports=a})();