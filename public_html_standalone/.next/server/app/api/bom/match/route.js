"use strict";(()=>{var e={};e.id=7927,e.ids=[7927],e.modules={53524:e=>{e.exports=require("@prisma/client")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},64551:(e,t,i)=>{i.r(t),i.d(t,{headerHooks:()=>v,originalPathname:()=>k,patchFetch:()=>w,requestAsyncStorage:()=>d,routeModule:()=>p,serverHooks:()=>m,staticGenerationAsyncStorage:()=>l,staticGenerationBailout:()=>h});var r={};i.r(r),i.d(r,{POST:()=>c});var n=i(95419),s=i(69108),a=i(99678),o=i(78070),u=i(3214);async function c(e){try{let{items:t}=await e.json();if(!t||!Array.isArray(t))return o.Z.json({error:"Invalid input"},{status:400});let i=[],r=[];for(let e of t){let t=null,n=null;if(e.mpn&&(t=await u._.product.findFirst({where:{mpn:{contains:e.mpn,mode:"insensitive"}},include:{variants:{where:{isActive:!0},include:{stock:!0}}}})),!t&&e.sku&&(n=await u._.variant.findFirst({where:{sku:{contains:e.sku,mode:"insensitive"}},include:{product:!0,stock:!0}}))&&(t=n.product),!t&&e.description&&(t=await u._.product.findFirst({where:{OR:[{name:{contains:e.description,mode:"insensitive"}},{description:{contains:e.description,mode:"insensitive"}}]},include:{variants:{where:{isActive:!0},include:{stock:!0}}}})),t){let s=n||t.variants[0];s?i.push({item:e,product:t,variant:s,price:Number(s.price)}):r.push({item:e,suggestions:[]})}else{let t=await u._.product.findMany({where:{OR:[{name:{contains:e.description?.substring(0,20)||"",mode:"insensitive"}},{description:{contains:e.description?.substring(0,20)||"",mode:"insensitive"}}],active:!0},take:5,include:{variants:{where:{isActive:!0},take:1}}});r.push({item:e,suggestions:t.map(e=>({id:e.id,name:e.name,mpn:e.mpn,sku:e.sku,price:e.variants[0]?.price||0}))})}}return o.Z.json({matched:i,unmatched:r})}catch(e){return console.error("BOM match error:",e),o.Z.json({error:"Internal server error"},{status:500})}}let p=new n.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/bom/match/route",pathname:"/api/bom/match",filename:"route",bundlePath:"app/api/bom/match/route"},resolvedPagePath:"C:\\Users\\aslan\\Desktop\\masa\xfcst\xfc-10.25\\DIY_battery\\app\\api\\bom\\match\\route.ts",nextConfigOutput:"standalone",userland:r}),{requestAsyncStorage:d,staticGenerationAsyncStorage:l,serverHooks:m,headerHooks:v,staticGenerationBailout:h}=p,k="/api/bom/match/route";function w(){return(0,a.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:l})}},3214:(e,t,i)=>{i.d(t,{_:()=>n});var r=i(53524);let n=globalThis.prisma??new r.PrismaClient({log:["error"]})}};var t=require("../../../../webpack-runtime.js");t.C(e);var i=e=>t(t.s=e),r=t.X(0,[1638,6206],()=>i(64551));module.exports=r})();